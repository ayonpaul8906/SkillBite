import { useEffect } from "react";
import { motion } from "framer-motion";
import { BookOpen, PlayCircle, BarChart3, LogOut, User, Compass } from "lucide-react";
import { Button } from "../components/ui/button";
import { useNavigate } from "react-router-dom";
import { signOut } from "firebase/auth";
import { auth } from "../lib/firebase";

function Dashboard({ user }) {
  const navigate = useNavigate();

  const displayName = user?.displayName || "Learner";
  const avatar = user?.photoURL || "/logo.jpg";

  const handleLogout = async () => {
    await signOut(auth);
    navigate("/");
  };

  useEffect(() => {
    window.scrollTo(0, 0);
  }, []);

  return (
    <div className="min-h-screen flex flex-col bg-gradient-to-br from-white via-indigo-50 to-pink-50 font-inter">

      {/* ─── Navbar ─────────────────────────────────────────────────── */}
      <header className="bg-white shadow-md px-6 py-4 flex justify-between items-center">
        <div className="flex items-center gap-3">
          <img src="/logo.jpg" alt="Logo" className="w-10 h-10 rounded-md" />
          <h1 className="text-xl font-bold text-indigo-700">SkillBite</h1>
        </div>
        <nav className="hidden sm:flex gap-6 text-indigo-700 font-medium">
          <button onClick={() => navigate("/explore")} className="hover:text-indigo-500 flex items-center gap-1">
            <Compass size={18} /> Explore
          </button>
          <button onClick={() => navigate("/library")} className="hover:text-indigo-500 flex items-center gap-1">
            <BookOpen size={18} /> Library
          </button>
          <button onClick={() => navigate("/profile")} className="hover:text-indigo-500 flex items-center gap-1">
            <User size={18} /> Profile
          </button>
        </nav>
        <Button variant="outline" onClick={handleLogout} className="flex items-center gap-1 text-sm text-red-600">
          <LogOut size={16} /> Logout
        </Button>
      </header>

      {/* ─── Main Content ────────────────────────────────────────────── */}
      <main className="flex-1 px-6 py-8">
        <div className="mb-8 text-center">
          <h2 className="text-3xl font-bold text-indigo-700 mb-1">Welcome, {displayName} 👋</h2>
          <p className="text-slate-600 text-sm">Empowering your learning journey one bite at a time.</p>
        </div>

        {/* Quick Action Cards */}
        <div className="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 mb-12">
          {[
            {
              icon: <PlayCircle className="w-8 h-8 text-indigo-600" />,
              title: "Start AI Lesson",
              desc: "Let Gemini generate a bite-sized lesson just for you.",
              action: "Learn Now",
              to: "/recommend"
            },
            {
              icon: <BarChart3 className="w-8 h-8 text-green-600" />,
              title: "View Progress",
              desc: "Track how far you've come and what’s next.",
              action: "Track Progress",
              to: "/progress"
            },
            {
              icon: <BookOpen className="w-8 h-8 text-pink-600" />,
              title: "Browse Library",
              desc: "Explore topics and completed lessons.",
              action: "Explore",
              to: "/library"
            }
          ].map(({ icon, title, desc, action, to }, i) => (
            <motion.div
              key={i}
              whileHover={{ scale: 1.04 }}
              transition={{ duration: 0.3 }}
              onClick={() => navigate(to)}
              className="bg-white rounded-2xl shadow-xl p-6 hover:shadow-2xl border border-indigo-100 cursor-pointer"
            >
              <div className="flex items-center gap-4 mb-4">
                <div className="bg-indigo-100 rounded-full p-2">{icon}</div>
                <h3 className="text-lg font-semibold text-indigo-800">{title}</h3>
              </div>
              <p className="text-slate-600 mb-4 text-sm">{desc}</p>
              <Button className="bg-gradient-to-tr from-indigo-500 via-pink-500 to-yellow-400 text-white text-sm w-full shadow-md">
                {action}
              </Button>
            </motion.div>
          ))}
        </div>

        {/* Daily Motivation */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.3, duration: 0.8 }}
          className="bg-gradient-to-r from-indigo-100 to-pink-100 text-center py-6 rounded-2xl shadow-lg"
        >
          <h2 className="text-xl font-bold text-indigo-700 mb-2">“Every bite of knowledge counts.”</h2>
          <p className="text-slate-600 text-sm">Stay consistent. Stay curious. 🚀</p>
        </motion.div>
      </main>

      {/* ─── Footer ───────────────────────────────────────────────────── */}
      <footer className="bg-white mt-10 py-4 px-6 border-t border-slate-100 text-center text-sm text-slate-600">
        <div className="flex flex-col sm:flex-row justify-between items-center">
          <p className="text-center">© 2025 SkillBite. All rights reserved.</p>
          <div className="flex gap-4 mt-2 sm:mt-0">
            <a href="/about" className="hover:text-indigo-500">About</a>
            <a href="/contact" className="hover:text-indigo-500">Contact</a>
            <a href="https://github.com/your-project" className="hover:text-indigo-500" target="_blank" rel="noreferrer">GitHub</a>
          </div>
        </div>
      </footer>
    </div>
  );
}

export default Dashboard;
